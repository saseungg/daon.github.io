{"componentChunkName":"component---src-templates-blog-post-js","path":"/tip/github-action/","result":{"data":{"site":{"siteMetadata":{"title":"DAONLOG","author":"saseungg","siteUrl":"https://saseungg.github.io","comment":{"utterances":"saseungg/saseungg.github.io"}}},"markdownRemark":{"id":"5fe864a2-6341-580d-9829-a16c8fd4d35a","excerpt":"Github Actions는 워크플로를 자동화하는 도구로, YAML 파일을 사용하여 빌드, 테스트, 배포 등 다양한 작업을 자동화할 수 있다. 블로그를 gh-pages로 배포했지만 글을 작성할 때마다 npm deploy를 매번 입력해주는게 번거로웠기 때문에 Github Actions를 통해 배포 과정을 자동화하기로 했다. 워크플로 등록  폴더에  파일을 추가하여 워크 플로우를 등록하자. Github Actions는 저장소에 이벤트가 발생할 때 워크플로를 실행할 수 있게 해준다. main…","html":"<p>Github Actions는 워크플로를 자동화하는 도구로, YAML 파일을 사용하여 빌드, 테스트, 배포 등 다양한 작업을 자동화할 수 있다.</p>\n<p>블로그를 gh-pages로 배포했지만 글을 작성할 때마다 npm deploy를 매번 입력해주는게 번거로웠기 때문에 Github Actions를 통해 배포 과정을 자동화하기로 했다.</p>\n<h2 id=\"워크플로-등록\" style=\"position:relative;\"><a href=\"#%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C-%EB%93%B1%EB%A1%9D\" aria-label=\"워크플로 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>워크플로 등록</h2>\n<p><code class=\"language-text\">github/workflows</code> 폴더에 <code class=\"language-text\">deploy.yml</code> 파일을 추가하여 워크 플로우를 등록하자.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> build gatsby <span class=\"token comment\"># 워크플로 이름</span>\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">push</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> main</code></pre></div>\n<p>Github Actions는 저장소에 이벤트가 발생할 때 워크플로를 실행할 수 있게 해준다. main 브랜치에 푸시하면 워크플로를 실행하도록 설정했다.</p>\n<h3 id=\"작업-정의\" style=\"position:relative;\"><a href=\"#%EC%9E%91%EC%97%85-%EC%A0%95%EC%9D%98\" aria-label=\"작업 정의 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>작업 정의</h3>\n<p>워크플로 내에서 실행할 작업을 정의해보자. 이벤트가 트리거되면 jobs에 정의한 작업들이 순차적으로 실행된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build_gatsby</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> build\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v1\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'14.15.0'</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install dependencies\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm install\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> peaceiris/actions<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages@v2\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 환경 변수 설정</span>\n          <span class=\"token key atrule\">GITHUB_TOKEN</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.GH_TOKEN <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">PUBLISH_BRANCH</span><span class=\"token punctuation\">:</span> deployment\n          <span class=\"token key atrule\">PUBLISH_DIR</span><span class=\"token punctuation\">:</span> ./public</code></pre></div>\n<ol>\n<li>runs-on은 Github에서 호스팅되는 가상 환경을 의미한다. 이 레포는 ubuntu-latest 환경에서 실행된다.</li>\n<li>워크플로에서 레포에 있는 코드를 사용할 때 체크아웃을 작업을 해줘야하기 때문에 <code class=\"language-text\">actions/checkout</code> 액션을 사용해서 코드를 가져온다.</li>\n<li><code class=\"language-text\">actions/setup-node</code>를 사용하여 Node.js 버전을 설치한다. 로컬 프로젝트 노드 버전과 동일하게 기재해주자.</li>\n<li>종속성을 설치하고, Gatsby 프로젝트를 빌드하고, 배포를 위해 <code class=\"language-text\">peaceiris/actions-gh-pages@v2</code> 액션을 사용한다.</li>\n</ol>\n<p>이러한 과정들을 시각화를 해보았다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAQL/2gAMAwEAAhADEAAAAe0rUsmSwv8A/8QAGRAAAwADAAAAAAAAAAAAAAAAAAECAxNB/9oACAEBAAEFAljlVrgmVKOn/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAS/9oACAEDAQE/AZC//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGhAAAQUBAAAAAAAAAAAAAAAAABEgITFBof/aAAgBAQAGPwJdK6Qz/8QAHBAAAwABBQAAAAAAAAAAAAAAAAERcRAhMYGh/9oACAEBAAE/IYKn2HTf2JRYs6YC4P/aAAwDAQACAAMAAAAQrN//xAAXEQEBAQEAAAAAAAAAAAAAAAABACFh/9oACAEDAQE/EOMAYX//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQIBAT8QgX//xAAeEAEBAAIABwAAAAAAAAAAAAABEQAhEDFBUXGB4f/aAAgBAQABPxBiYlbXXnrKonep5UxGxTv3wRKV5v3Haz//2Q=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"workflow\"\n        title=\"workflow\"\n        src=\"/static/e09ab8bdeef4a1b5128365658e8626df/29d31/workflow.jpg\"\n        srcset=\"/static/e09ab8bdeef4a1b5128365658e8626df/e52aa/workflow.jpg 175w,\n/static/e09ab8bdeef4a1b5128365658e8626df/70ebb/workflow.jpg 350w,\n/static/e09ab8bdeef4a1b5128365658e8626df/29d31/workflow.jpg 700w,\n/static/e09ab8bdeef4a1b5128365658e8626df/9ecec/workflow.jpg 1050w,\n/static/e09ab8bdeef4a1b5128365658e8626df/d165a/workflow.jpg 1400w,\n/static/e09ab8bdeef4a1b5128365658e8626df/9f3a0/workflow.jpg 1706w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>정리하자면, 이벤트가 트리거되는 순간 build gatsby라는 이름의 워크플로가 실행이 되며, ubuntu-latest 환경에서 step 1 -> step 2 … 단계별로 실행하며 gh-pages로 배포가 된 후 deployment 브랜치에 푸쉬된다.</p>\n<h2 id=\"환경-변수-등록\" style=\"position:relative;\"><a href=\"#%ED%99%98%EA%B2%BD-%EB%B3%80%EC%88%98-%EB%93%B1%EB%A1%9D\" aria-label=\"환경 변수 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>환경 변수 등록</h2>\n<p><code class=\"language-text\">Settings > Security > Secrets and variables > actions</code> 에서 환경 변수를 등록 해준다.</p>\n<p>key는 yml에서 지정한 환경 변수 이름과 똑같이 GH_TOKEN으로 하고 value에 토큰 값을 입력해주고 저장하면 된다.</p>\n<p align=\"center\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 700px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 20%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAG8AD//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAEFAn//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAQ/9oACAEBAAY/An//xAAWEAEBAQAAAAAAAAAAAAAAAAABABD/2gAIAQEAAT8hCc//2gAMAwEAAgADAAAAEHPP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAFRABAQAAAAAAAAAAAAAAAAAAAQD/2gAIAQEAAT8QIWEX/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"secret variables\" title=\"secret variables\" src=\"/static/a9bdddc9a0c1ae779c544e0bb2f4919a/29d31/secrets%20variables.jpg\" srcset=\"/static/a9bdddc9a0c1ae779c544e0bb2f4919a/e52aa/secrets%20variables.jpg 175w,\n/static/a9bdddc9a0c1ae779c544e0bb2f4919a/70ebb/secrets%20variables.jpg 350w,\n/static/a9bdddc9a0c1ae779c544e0bb2f4919a/29d31/secrets%20variables.jpg 700w,\n/static/a9bdddc9a0c1ae779c544e0bb2f4919a/9ecec/secrets%20variables.jpg 1050w,\n/static/a9bdddc9a0c1ae779c544e0bb2f4919a/179bc/secrets%20variables.jpg 1304w\" sizes=\"(max-width: 700px) 100vw, 700px\" loading=\"lazy\">\n    </span>\n</p>\n<h2 id=\"references\" style=\"position:relative;\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h2>\n<ul>\n<li><a href=\"https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions\">Understanding GitHub Actions</a></li>\n</ul>","frontmatter":{"title":"🤖 Github Actions을 통한 배포 자동화","date":"October 30, 2023"}}},"pageContext":{"slug":"/tip/github-action/","previous":{"fields":{"slug":"/tip/node-version/"},"frontmatter":{"title":"📦 nvm으로 노드 버전관리 자동화하기"}},"next":{"fields":{"slug":"/project/msw/"},"frontmatter":{"title":"👾 MSW로 목데이터 만들기"}}}},"staticQueryHashes":["3128451518","3958338973"]}